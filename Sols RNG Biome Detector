local SoundService = game:GetService("SoundService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local TARGET_SOUND_ID = "rbxassetid://9043887091"
local TARGET_SOUND_GROUP = "PlayerBackgroundMusic"
local NOTIFICATION_TITLE = "Biome Detector"
local RAINY_START_TEXT = "Rainy Biome Has Started!"
local RAINY_END_TEXT = "Rainy Biome Has Ended!"

local localPlayer = Players.LocalPlayer
local lastSoundState = false

local function checkSounds()
    local currentSoundState = false
    
    for _, sound in ipairs(SoundService:GetDescendants()) do
        if sound:IsA("Sound") then
            if tostring(sound.SoundId) == TARGET_SOUND_ID 
               and sound.SoundGroup and sound.SoundGroup.Name == TARGET_SOUND_GROUP 
               and sound.IsPlaying then
                currentSoundState = true
                break
            end
        end
    end
    
    if currentSoundState ~= lastSoundState then
        if currentSoundState then
            localPlayer:SetAttribute("BiomeStatus", "Rainy")
            localPlayer:SendNotification({
                Title = NOTIFICATION_TITLE,
                Text = RAINY_START_TEXT,
                Icon = "",
                Duration = 5
            })
        else
            localPlayer:SetAttribute("BiomeStatus", "None")
            localPlayer:SendNotification({
                Title = NOTIFICATION_TITLE,
                Text = RAINY_END_TEXT,
                Icon = "",
                Duration = 5
            })
        end
        lastSoundState = currentSoundState
    end
end

RunService.Heartbeat:Connect(checkSounds)
