local HttpService = game:GetService("HttpService")
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local window = Rayfield:CreateWindow({
    Name = "Text Message - Alpha Hax",
    LoadingTitle = "Loading Assets..",
    LoadingSubtitle = "Created By Luxx",
    ConfigurationSaving = {
        Enabled = false,
        FileName = "Sirius"
    },
    KeySystem = true,
    KeySettings = {
        Title = "Luxx's Key System",
        Subtitle = "Enter Your Key",
        Note = "Rate The Features",
        FileName = "Sirius",
        SaveKey = false,
        Key = "2025"
    }
})

local chatTab = window:CreateTab("Chat")
local chatSection = chatTab:CreateSection("Chat")

local function checkGrammar(text)
    local url = "https://api.languagetool.org/v2/check"
    local data = { text = text, language = "en" }
    local response = HttpService:PostAsync(url, HttpService:JSONEncode(data), Enum.HttpContentType.ApplicationJson)
    local result = HttpService:JSONDecode(response)

    if result.matches and #result.matches > 0 then
        for _, match in ipairs(result.matches) do
            text = text:gsub(match.context.text, match.replacements[1].value)
        end
    end

    return text
end

local messageInput = chatTab:CreateInput({
    Name = "Send Chat Message",
    CurrentValue = "",
    PlaceholderText = "Type a message...",
    RemoveTextAfterFocusLost = false,
    Flag = "Input1",
    Callback = function(text)
        local emojiReplacements = {
            [":skull:"] = "ğŸ’€",
            [":exploding_head:"] = "ğŸ¤¯",
            [":nerd:"] = "ğŸ¤“",
            [":thinking:"] = "ğŸ¤”",
            [":x:"] = "âŒ",
            [":moai:"] = "ğŸ—¿",
            [":smiling_imp:"] = "ğŸ˜ˆ",
            [":clown:"] = "ğŸ¤¡",
            [":broken_heart:"] = "ğŸ’”",
            [":cap:"] = "ğŸ§¢",
            [":fire:"] = "ğŸ”¥",
            [":sunglasses:"] = "ğŸ˜",
            [":cold_face:"] = "ğŸ¥¶",
            [":eyes:"] = "ğŸ‘€",
            [":sob:"] = "ğŸ˜­",
            [":cry:"] = "ğŸ˜¢",
            [":pray:"] = "ğŸ™",
            [":heart:"] = "â¤ï¸",
            [":shush:"] = "ğŸ¤«",
            [":rat:"] = "ğŸ€",
            [":raised_eyebrow:"] = "ğŸ¤¨",
            [":check_mark:"] = "âœ…",
            [":stuck_out_tounge:"] = "ğŸ˜›",
            [":poop:"] = "ğŸ’©",
            [":money_face:"] = "ğŸ¤‘",
            [":angry:"] = "ğŸ˜ ",
            [":robot:"] = "ğŸ¤–",
            [":beaming_face:"] = "ğŸ˜",
            [":slightly_smiling:"] = "ğŸ™‚",
            [":joy:"] = "ğŸ˜‚",
            [":wilted_flower:"] = "ğŸ¥€"
        }

        for code, emoji in pairs(emojiReplacements) do
            text = text:gsub(code, emoji)
        end

        text = checkGrammar(text)

        local TextChatService = game:GetService("TextChatService")
        local chatChannel = TextChatService.TextChannels.RBXGeneral

        if chatChannel then
            chatChannel:SendAsync(text)
        else
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local sayMessageEvent = ReplicatedStorage:WaitForChild("DefaultChatSystemChatEvents"):FindFirstChild("SayMessageRequest")

            if sayMessageEvent then
                sayMessageEvent:FireServer(text, "All")
            end
        end
    end
})
